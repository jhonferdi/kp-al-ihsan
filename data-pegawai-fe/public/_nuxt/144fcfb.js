(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{157:function(e,t,r){"use strict";r.r(t);var n=r(22),c=(r(55),r(50),r(38)),o=r.n(c),l=r(108),m=r.n(l);r(107),r(78),r(33);function f(e){var t="page=".concat(e.currentPage,"&perpage=").concat(e.perPage,"&sortby=").concat(e.sortBy,"&filter=").concat(e.filter,"&sortdesc=").concat(e.sortDesc);if(e.params)for(var r in e.params)e.params.hasOwnProperty(r)&&(t+="&params["+r+"]="+e.params[r]);return t}var d={middleware:"auth",head:function(){return{title:"Manage Users"}},asyncData:function(){return Object(n.a)(regeneratorRuntime.mark((function e(){var t,r,n,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.tablectxuser?window.tablectxuser:{currentPage:1,perPage:20,filter:"",sortBy:"",sortDesc:!1,params:{kabkot_id:""}},e.next=3,o.a.get("/users?"+f(t));case 3:return r=e.sent.data,n=r.data,c=r.count,l=r.stats.kabkot,e.abrupt("return",{users:n,users_count:c,ctx:t,kabkotoption:l});case 8:case"end":return e.stop()}}),e)})))()},data:function(){return{fields:[{key:"name",label:"Name",sortable:!0,sortDirection:"asc"},{key:"email",label:"Email",sortable:!0},{key:"kabkot",label:"Kabupaten/Kota",sortable:!0},{key:"roles",label:"Roles"},{key:"actions",label:"Actions"}],isTableInit:!1,isBusy:!1}},methods:{itemsProvider:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.isTableInit){r.next=3;break}return t.isTableInit=!0,r.abrupt("return",t.users);case 3:return e.params=t.ctx.params,t.isBusy=!0,r.prev=5,window.tablectxuser=e,r.next=9,o.a.get("/users?"+f(e));case 9:return n=r.sent,t.isBusy=!1,t.users_count=n.data.count,r.abrupt("return",n.data.data);case 15:return r.prev=15,r.t0=r.catch(5),t.isBusy=!1,r.abrupt("return",[]);case 19:case"end":return r.stop()}}),r,null,[[5,15]])})))()},promptDelete:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:m.a.fire({title:"Apakah Anda yakin hendak menghapus "+e.name+"?",showDenyButton:!0,confirmButtonText:"Hapus",denyButtonText:"Batal"}).then(function(){var r=Object(n.a)(regeneratorRuntime.mark((function r(n){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n.isConfirmed){r.next=6;break}return r.next=3,o.a.delete("/users/".concat(e.id));case 3:r.sent,m.a.fire({icon:"success",title:"Berhasil",text:"Data berhasil dihapus",confirmButtonText:"Ok"}),t.$refs.table.refresh();case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},refreshTable:function(){this.$refs.table.refresh()}}},k=d,v=r(19),component=Object(v.a)(k,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("b-card",[r("b-row",{staticClass:"my-1"},[r("b-col",{attrs:{sm:"6"}},[r("div",{staticClass:"d-flex align-items-center mb-3"},[r("div",{staticClass:"mr-4 text-nowrap"},[e._v("Search User")]),e._v(" "),r("b-form-input",{staticClass:"w-100",attrs:{placeholder:"Enter user name"},model:{value:e.ctx.filter,callback:function(t){e.$set(e.ctx,"filter",t)},expression:"ctx.filter"}})],1)]),e._v(" "),r("b-col",{attrs:{sm:"6"}},[r("div",{staticClass:"d-flex align-items-center mb-3"},[r("div",{staticClass:"mr-4 text-nowrap"},[e._v("Filter Role")]),e._v(" "),r("b-form-select",{attrs:{options:e.kabkotoption,"value-field":"id","text-field":"name"},on:{change:e.refreshTable},model:{value:e.ctx.params.kabkot_id,callback:function(t){e.$set(e.ctx.params,"kabkot_id",t)},expression:"ctx.params.kabkot_id"}})],1)])],1),e._v(" "),r("div",{staticClass:"d-flex justify-content-between mb-1"},[r("h2",[e._v("Users ("+e._s(e.users_count)+")")]),e._v(" "),r("div",[r("b-button",{attrs:{variant:"primary",to:"/user/create"}},[r("b-icon",{attrs:{icon:"plus"}}),e._v(" New user\n      ")],1)],1)]),e._v(" "),r("b-table",{ref:"table",attrs:{hover:"",responsive:"",items:e.itemsProvider,"current-page":e.ctx.currentPage,"per-page":e.ctx.perPage,filter:e.ctx.filter,"filter-debounce":300,busy:e.isBusy,sortBy:e.ctx.sortBy,sortDesc:e.ctx.sortDesc,fields:e.fields},scopedSlots:e._u([{key:"cell(name)",fn:function(t){return[r("nuxt-link",{attrs:{to:{name:"user.detail",params:{id:t.item.id}}}},[e._v(e._s(t.item.name))])]}},{key:"cell(kabkot)",fn:function(t){return[e._v("\n      "+e._s(t.item.kabkot.nama)+"\n    ")]}},{key:"cell(roles)",fn:function(t){return[r("div",[r("span",[e._v("\n          "+e._s(t.item.role.name)),r("br")])])]}},{key:"cell(actions)",fn:function(t){return[r("nuxt-link",{staticClass:"mr-2",attrs:{to:{name:"user.edit",params:{id:t.item.id}}}},[r("b-icon",{attrs:{icon:"pencil"}})],1),e._v(" "),r("a",{staticStyle:{cursor:"pointer",color:"red"},on:{click:function(r){return e.promptDelete(t.item)}}},[r("b-icon",{attrs:{icon:"trash"}})],1)]}}])}),e._v(" "),r("b-pagination",{attrs:{"total-rows":e.users_count,"per-page":e.ctx.perPage,"aria-controls":"my-table"},model:{value:e.ctx.currentPage,callback:function(t){e.$set(e.ctx,"currentPage",t)},expression:"ctx.currentPage"}})],1)}),[],!1,null,null,null);t.default=component.exports}}]);